---
layout: single
title: "[TIL] 1ì¸ì¹­, 3ì¸ì¹­ ì‹œì  ì¹´ë©”ë¼"
categories:
tag: [TIL, Unity, C#]
toc: true
toc_sticky: true
toc_label: ëª©ì°¨
author_profile: false
excerpt: ""
---

# ğŸ“–í•™ìŠµ ë‚´ìš©

1ì¸ì¹­, 3ì¸ì¹­ì„ ì „í™˜í•  ìˆ˜ ìˆëŠ” ì¹´ë©”ë¼ ë¡œì§ì„ ë§Œë“¤ì–´ ë³´ì•˜ë‹¤.

```c#
public class CameraCtrl : MonoBehaviour
{
    private Transform playerBody; // í”Œë ˆì´ì–´ ìºë¦­í„°ì˜ Transform (Yì¶• íšŒì „ ì£¼ì²´)

    [Header("ë§ˆìš°ìŠ¤ ë° íšŒì „ ì„¤ì •")]
    [SerializeField] private float mouseSensitivity = 200f;
    [SerializeField] private float minPitch = -80f; // ìµœì†Œ ìƒí•˜ ê°ë„
    [SerializeField] private float maxPitch = 80f;  // ìµœëŒ€ ìƒí•˜ ê°ë„

    [Header("1ì¸ì¹­ ì‹œì  ì„¤ì •")]
    [SerializeField] private Vector3 firstPersonLocalPosition = new Vector3(0f, 0f, 0f); // MountPoint ê¸°ì¤€ ìœ„ì¹˜
    [SerializeField] private LayerMask firstPersonLayer;
    private Transform firstPersonParent;


    [Header("3ì¸ì¹­ ì‹œì  ì„¤ì •")]
    [SerializeField] private Vector3 thirdPersonTargetOffset = new Vector3(0f, 1.2f, 0f);
    [SerializeField] private float thirdPersonDistance = 3.5f;
    [SerializeField] private LayerMask thirdPersonLayer;
    // 3ì¸ì¹­ ì‹œ PitchëŠ” ë§ˆìš°ìŠ¤ ì…ë ¥ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©. ë³„ë„ Height ì„¤ì • ëŒ€ì‹  Pitchë¡œ ì¡°ì ˆ.

    private float yaw = 0.0f;   // í˜„ì¬ Yì¶• íšŒì „ê°’ (ì¢Œìš°)
    private float pitch = 0.0f; // í˜„ì¬ Xì¶• íšŒì „ê°’ (ìƒí•˜)
    private bool isFirstPerson = true;
    private Vector2 mouseDelta;
    private Camera cam;

    void Start()
    {
        playerBody = transform.root;
        firstPersonParent = transform.parent;
        cam = GetComponent<Camera>();

        // ì´ˆê¸° YawëŠ” í”Œë ˆì´ì–´ì˜ í˜„ì¬ Yì¶• íšŒì „ê°’ì„ ë”°ë¦„
        yaw = playerBody.eulerAngles.y;
        // ì´ˆê¸° PitchëŠ” í˜„ì¬ ì¹´ë©”ë¼ì˜ Xì¶• íšŒì „ê°’ì„ ë”°ë¥´ê±°ë‚˜ 0ìœ¼ë¡œ ì‹œì‘
        // (ì¹´ë©”ë¼ê°€ ì´ˆê¸°ì— íŠ¹ì • ê°ë„ë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´ í•´ë‹¹ ê°’ìœ¼ë¡œ, ì•„ë‹ˆë©´ 0)
        pitch = transform.localEulerAngles.x;
        if (pitch > 180) pitch -= 360; // ê°ë„ë¥¼ -180 ~ 180 ë²”ìœ„ë¡œ ë³€í™˜

        Cursor.lockState = CursorLockMode.Locked;
        Cursor.visible = false;

        ApplyCameraView(); // ì´ˆê¸° ì‹œì  ì ìš©
    }

    void Update()
    {
        yaw += mouseDelta.x * mouseSensitivity * Time.deltaTime;
        pitch -= mouseDelta.y * mouseSensitivity * Time.deltaTime;
        pitch = Mathf.Clamp(pitch, minPitch, maxPitch); // Pitch ê°’ ë²”ìœ„ ì œí•œ
        pitch = Mathf.Clamp(pitch, minPitch, maxPitch); // Pitch ê°’ ë²”ìœ„ ì œí•œ
    }

    void LateUpdate()
    {
        // LateUpdateì—ì„œ ì¹´ë©”ë¼ ìœ„ì¹˜/íšŒì „ ìµœì¢… ì ìš© (í”Œë ˆì´ì–´ ì´ë™ í›„)
        ApplyCameraView();
    }

    void ApplyCameraView()
    {
        // í”Œë ˆì´ì–´ ëª¸ì²´ Yì¶• íšŒì „ ì ìš© (1ì¸ì¹­, 3ì¸ì¹­ ê³µí†µ)
        playerBody.rotation = Quaternion.Euler(0, yaw, 0);

        if (isFirstPerson)
        {
            // 1ì¸ì¹­ ì‹œì 
            transform.parent = firstPersonParent;
            transform.localPosition = firstPersonLocalPosition;
            transform.localRotation = Quaternion.Euler(pitch, 0, 0); // ë¡œì»¬ Xì¶• íšŒì „ë§Œ Pitch ì ìš©
        }
        else
        {
            //  3ì¸ì¹­ ì‹œì 
            if (transform.parent != null)
            {
                transform.SetParent(null); // ì›”ë“œ ê¸°ì¤€ìœ¼ë¡œ ìœ„ì¹˜ ì„¤ì •í•˜ê¸° ìœ„í•´ ë¶€ëª¨ í•´ì œ
            }

            // ì¹´ë©”ë¼ê°€ ë°”ë¼ë³¼ ëª©í‘œ ì§€ì  (í”Œë ˆì´ì–´ ë¡œì»¬ ì˜¤í”„ì…‹ -> ì›”ë“œ ì¢Œí‘œ)
            Vector3 lookAtTargetWorld = playerBody.position + playerBody.TransformDirection(thirdPersonTargetOffset);

            // ëª©í‘œ ì¹´ë©”ë¼ íšŒì „ (ë§ˆìš°ìŠ¤ Yawì™€ Pitch ëª¨ë‘ ì‚¬ìš©)
            Quaternion desiredRotation = Quaternion.Euler(pitch, yaw, 0);

            // ëª©í‘œ ì¹´ë©”ë¼ ìœ„ì¹˜ (ëª©í‘œ ì§€ì ì—ì„œ (íšŒì „ê°’ * ê±°ë¦¬) ë§Œí¼ ë’¤ë¡œ ì´ë™)
            Vector3 desiredPosition = lookAtTargetWorld - (desiredRotation * Vector3.forward * thirdPersonDistance);

            transform.position = desiredPosition;
            transform.LookAt(lookAtTargetWorld); // í•­ìƒ ëª©í‘œ ì§€ì ì„ ë°”ë¼ë³´ë„ë¡ ì„¤ì •
        }
    }

    public void OnLook(InputAction.CallbackContext context)
    {   //ì§€ì†ì ìœ¼ë¡œ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜´
        mouseDelta = context.ReadValue<Vector2>();
    }
    public void OnViewChange(InputAction.CallbackContext context)
    {   //ì¹´ë©”ë¼ ì „í™˜ ë²„íŠ¼ í´ë¦­ì‹œ í˜¸ì¶œ
        isFirstPerson = !isFirstPerson;
        EventBus.Raise(new PlayerViewChangeEvent(isFirstPerson));
        cam.cullingMask = isFirstPerson ? firstPersonLayer : thirdPersonLayer;
    }
}
```

# êµ¬í˜„ ê²°ê³¼

![gif_1]({{site.url}}/images/2025-05/viewSwitchCamera.gif)

**ë” ì¶”ê°€í•˜ê³  ì‹¶ì€ ê¸°ëŠ¥**

1. ë·° ì „í™˜ ì‹œ ìì—°ìŠ¤ëŸ¬ìš´ ì¤Œ ì•„ì›ƒ / ì¤Œ ì¸
2. í”Œë ˆì´ì–´ ë‹¬ë¦¬ê¸° ì‹œ ì•½ê°„ ëŠë¦¬ê²Œ ë”°ë¼ê°€ê±°ë‚˜ ì½”ë„ˆë¥¼ ë¸”ëŸ¬ì²˜ë¦¬í•˜ì—¬ ìŠ¤í”¼ë””í•œ ì—°ì¶œ
3. 3ì¸ì¹­ ë·°ì—ì„œ ì¹´ë©”ë¼ê°€ ë²½ì„ ëš«ì§€ ì•Šë„ë¡ êµ¬í˜„
