---
layout: single
title: "[TIL] ìœ ë‹ˆí‹° Input System í™œìš©"
categories:
tag: [TIL, C#, Unity]
toc: true
toc_sticky: true
toc_label: ëª©ì°¨
author_profile: false
excerpt: ""
---

---

# ğŸ“•í•™ìŠµ ê°œìš”

ìœ ë‹ˆí‹° ìº í”„ 18ì¼ì°¨.

ì˜¤ëŠ˜ë¶€í„° ë³¸ê²©ì ìœ¼ë¡œ 4ì£¼ì°¨ ê°œì¸ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í–ˆë‹¤. íŠœí„°ë‹˜ì˜ ê°•ì˜ì—ì„œ ì›Œë‚™ ê¹”ë”í•œ í”„ë¡œì íŠ¸ê°€ êµ¬í˜„ë˜ì—ˆë‹¤ ë³´ë‹ˆ í˜¼ì í•  ë•Œë„ ë­”ê°€ ì™„ë²½í•˜ê²Œ êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ìš•ì‹¬ì´ ìƒê¸°ê³ , ì´ ë•Œë¬¸ì— ì‹œê°„ì´ ë„ˆë¬´ ë§ì´ ì†Œëª¨ë˜ëŠ” ê²ƒ ê°™ë‹¤.

ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” í•œ ê²Œì„ ë‚´ ë‹¤ì–‘í•œ ë¯¸ë‹ˆê²Œì„ì´ ì¡´ì¬í•˜ëŠ” ì¼ì¢…ì˜ ë©”íƒ€ë²„ìŠ¤ í”„ë¡œì íŠ¸ ì´ë¯€ë¡œ, ê°ì¢… ë¯¸ë‹ˆê²Œì„ ë§ˆë‹¤ ë°”ë€ŒëŠ” í”Œë ˆì´ì–´ì˜ ì»¨íŠ¸ë¡¤ ë°©ì‹ì„ ì–´ë–»ê²Œ êµ¬í˜„í•  ì§€ ë§ì€ ê³ ë¯¼ì„ í–ˆë‹¤. ì „ëµ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„í•´ë³´ë‹¤ê°€ ë­”ê°€ ë„ˆë¬´ ê³¼í•˜ë‹¤ ì‹¶ì–´ íŠœí„°ë‹˜ì˜ ë„ì›€ì„ ë°›ì•˜ëŠ”ë°, Input System ì„ ì‚¬ìš©í•´ë³´ë¼ëŠ” ì¡°ì–¸ì„ ë°›ì•˜ë‹¤. ë‚´ê°€ ì™œ ê·¸ ìƒê°ì„ ëª»í–ˆì„ê¹Œ.

ì—¬íƒœ ìœ ë‹ˆí‹°ì˜ ì¸í’‹ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•´ ë³¸ ì ì€ ìˆì§€ë§Œ, ê·¸ëƒ¥ ë‹¨ìˆœí•˜ê²Œ í•œ ì¢…ë¥˜ì˜ ë§µí•‘ë§Œ ë°›ì•„ì™€ì„œ í•´ë³¸ê²Œ ì „ë¶€, ë‹¤ì–‘í•œ ë§µí•‘ì„ ììœ ë¡­ê²Œ ë³€í™˜í•˜ë©° ì»¨íŠ¸ë¡¤ ë°©ì‹ì„ ë°”ê¾¸ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•´ë³¸ ê±´ ì²˜ìŒì´ì—ˆë‹¤.

---

# ğŸ“–í•™ìŠµ ë‚´ìš©

## Input System í™œìš©

### 1. ê¸°ë³¸ ì„¤ì • ë° êµ¬ì¡°

- **Input Actions Asset (`.inputactions`):** í”„ë¡œì íŠ¸ ë‚´ì—ì„œ ì…ë ¥ì„ ì •ì˜í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì¤‘ì•™ ì—ì…‹.
- **Action Maps:** ê²Œì„ ìƒíƒœë‚˜ ë¯¸ë‹ˆê²Œì„ë³„ë¡œ ì…ë ¥ ì„¸íŠ¸ë¥¼ ê·¸ë£¹í™” (ì˜ˆ: `MainMenu`, `PlayerPlatform`, `PlayerFlappy`). Scene ì „í™˜ì´ë‚˜ ê²Œì„ ìƒíƒœ ë³€ê²½ ì‹œ í™œì„±í™”/ë¹„í™œì„±í™”í•˜ì—¬ ì…ë ¥ ë°©ì‹ì„ ì „í™˜.
- **Actions:** ê°œë³„ ì…ë ¥ ë™ì‘ ì •ì˜ (ì˜ˆ: `Move`, `Jump`, `Look`).
  - **Action Type:** `Value` (ì§€ì†ì ì¸ ê°’), `Button` (ëˆŒë¦¼/ë—Œ ìƒíƒœ), `Pass Through` (ëª¨ë“  ë³€ê²½ ì „ë‹¬).
  - **Control Type:** ì˜ˆìƒë˜ëŠ” ê°’ì˜ íƒ€ì… (ì˜ˆ: `Vector2`, `Button`, `Axis`, `Float`).
- **Bindings:** ì‹¤ì œ ë¬¼ë¦¬ì  ì…ë ¥(í‚¤, ë§ˆìš°ìŠ¤ ë²„íŠ¼, ê²Œì„íŒ¨ë“œ ì¶•/ë²„íŠ¼ ë“±)ì„ Actionì— ì—°ê²°.
  - ë§ˆìš°ìŠ¤ í™”ë©´ ìœ„ì¹˜ ë°”ì¸ë”©: `Pointer > Position` (Control Type: `Vector2`).
- **Generate C# Class:** Input Actions ì—ì…‹ Inspectorì—ì„œ í™œì„±í™” ì‹œ, ì—ì…‹ êµ¬ì¡°ë¥¼ ë°˜ì˜í•˜ëŠ” C# í´ë˜ìŠ¤ ìë™ ìƒì„±. ì½”ë“œì—ì„œ íƒ€ì… ì•ˆì „í•˜ê²Œ Action ë° Mapì— ì ‘ê·¼ ê°€ëŠ¥. **ë³€ê²½ í›„ì—ëŠ” ë°˜ë“œì‹œ "Apply" í´ë¦­.**

---

### 2. ìŠ¤í¬ë¦½íŠ¸ì—ì„œì˜ ì‚¬ìš©ë²• (Generated C# Class ê¸°ë°˜)

- **ì¸ìŠ¤í„´ìŠ¤í™”:** `Awake` ë“±ì—ì„œ ìƒì„±ëœ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±.

  ```csharp
  private PlayerInputSystem playerInputSystem; // PlayerInputSystemì€ ìƒì„±ëœ í´ë˜ìŠ¤ ì´ë¦„

  void Awake()
  {
      playerInputSystem = new PlayerInputSystem();
  }
  ```

- **Action/Map ì°¸ì¡°:** ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í†µí•´ Action Mapê³¼ Actionì— ì ‘ê·¼.

  ```csharp
  private InputActionMap platformMap;
  private InputAction moveAction;
  private InputAction lookAction;

  void Awake()
  {
      // ... ì¸ìŠ¤í„´ìŠ¤í™” ...
      platformMap = playerInputSystem.PlayerPlatform; // "PlayerPlatform"ì€ Action Map ì´ë¦„
      moveAction = platformMap.FindAction("Move");    // "Move"ëŠ” Action ì´ë¦„
      // ë˜ëŠ” ì§ì ‘ ì ‘ê·¼: moveAction = playerInputSystem.PlayerPlatform.Move;
      lookAction = platformMap.FindAction("Look");
  }
  ```

- **í™œì„±í™”/ë¹„í™œì„±í™” (Lifecycle):**
  - `OnEnable()`: ì‚¬ìš©í•  Action Map í™œì„±í™” (`map.Enable()`), ê°œë³„ Action í™œì„±í™” (`action.Enable()`), ì´ë²¤íŠ¸ êµ¬ë… (`+=`).
  - `OnDisable()`: ì´ë²¤íŠ¸ êµ¬ë… í•´ì œ (`-=`), Action ë¹„í™œì„±í™” (`action.Disable()`), Map ë¹„í™œì„±í™” (`map.Disable()`). ë¦¬ì†ŒìŠ¤ ëˆ„ìˆ˜ ë°©ì§€ë¥¼ ìœ„í•´ í•„ìˆ˜!
  - `OnDestroy()`: Input System ì¸ìŠ¤í„´ìŠ¤ `Dispose()` (íŠ¹íˆ `DontDestroyOnLoad` ê°ì²´).
- **Action Map ì „í™˜:** íŠ¹ì • ê²Œì„ ìƒíƒœë‚˜ Sceneì— ë§ëŠ” Mapë§Œ í™œì„±í™”í•˜ëŠ” í•¨ìˆ˜ êµ¬í˜„.

  ```csharp
  public void SwitchActionMap(string mapName)
  {
      DisableAllActionMaps(); // ê¸°ì¡´ ë§µ ëª¨ë‘ ë¹„í™œì„±í™”
      InputActionMap targetMap = playerInputSystem.asset.FindActionMap(mapName);
      targetMap?.Enable(); // ìƒˆ ë§µ í™œì„±í™”
  }

  private void DisableAllActionMaps()
  {
      foreach (var map in playerInputSystem.asset.actionMaps) { map.Disable(); }
  }
  ```

- **ê°œë³„ Action í™œì„±í™” (`action.Enable()`):**

  - Action Mapì´ í™œì„±í™”ë˜ì–´ë„, `ReadValue()`ë¡œ í´ë§í•  Actionì€ ëª…ì‹œì ìœ¼ë¡œ `Enable()` í•´ì£¼ëŠ” ê²ƒì´ ì•ˆì „í•˜ê³  ëª…í™•í•¨ (íŠ¹íˆ `Update`ì—ì„œ ì§€ì†ì ìœ¼ë¡œ ê°’ì„ ì½ì„ ë•Œ).
  - ì´ë²¤íŠ¸ ê¸°ë°˜ Actionì€ êµ¬ë…(`+=`) ì‹œ ì•”ì‹œì ìœ¼ë¡œ ì²˜ë¦¬ë  ìˆ˜ ìˆì§€ë§Œ, ëª…ì‹œì  `Enable`/`Disable`ì´ ê¶Œì¥ë¨.

  ***

### 3. ì…ë ¥ ì²˜ë¦¬ ë°©ì‹

**í´ë§ (Polling)**

- `Update()` ë˜ëŠ” `FixedUpdate()` ë“±ì—ì„œ ë§¤ í”„ë ˆì„ í˜„ì¬ ì…ë ¥ ê°’ì„ ì½ì–´ì˜´.
- ì§€ì†ì ì¸ ì…ë ¥(ì´ë™, ë§ˆìš°ìŠ¤ ì¡°ì¤€ ë“±) ì²˜ë¦¬ì— ì í•©.
- ì‚¬ìš©ë²•: `action.ReadValue<T>()` (TëŠ” Control Typeê³¼ ì¼ì¹˜).
  ```csharp
  void Update()
  {
      Vector2 moveInput = moveAction.ReadValue<Vector2>();
      Vector2 mousePos = lookAction.ReadValue<Vector2>();
      // ... ê°’ ì‚¬ìš© ...
  }
  ```

**ì´ë²¤íŠ¸ ê¸°ë°˜ (Callbacks)**

- ì…ë ¥ ìƒíƒœ ë³€ê²½(ì‹œì‘, ìˆ˜í–‰, ì·¨ì†Œ ë“±) ì‹œì ì— ë“±ë¡ëœ í•¨ìˆ˜(ì½œë°±)ë¥¼ í˜¸ì¶œ.
- ë‹¨ë°œì„± ì…ë ¥(ì í”„, ë°œì‚¬, UI ìƒí˜¸ì‘ìš©) ë˜ëŠ” ì…ë ¥ ìƒíƒœ ë³€í™” ê°ì§€ì— ìœ ìš©.
- ì‚¬ìš©ë²•:

  - êµ¬ë…: `action.performed += CallbackFunction;`, `action.canceled += CallbackFunction;`, `action.started += ...` (`OnEnable`ì—ì„œ).
  - êµ¬ë… í•´ì œ: `action.performed -= CallbackFunction;` (`OnDisable`ì—ì„œ).
  - ì½œë°± í•¨ìˆ˜: `InputAction.CallbackContext`ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŒ.
  - ì½œë°± ë‚´ ê°’ ì½ê¸°: `context.ReadValue<T>()`.

  ```csharp
  void OnEnable() { jumpAction.performed += OnJump; }
  void OnDisable() { jumpAction.performed -= OnJump; }

  void OnJump(InputAction.CallbackContext context)
  {
      // ì í”„ ë¡œì§ ì‹¤í–‰
      Debug.Log("Jump performed!");
      // bool buttonState = context.ReadValueAsButton(); // ë²„íŠ¼ ìƒíƒœ ì½ê¸°
  }

  void OnMove(InputAction.CallbackContext context)
  {
      Vector2 input = context.ReadValue<Vector2>(); // Move ê°’ ì½ê¸°
      // ... ê°’ ì‚¬ìš© ...
  }
  ```

  ***

  # ğŸì˜¤ëŠ˜ ë°°ìš´ í•µì‹¬ ë‚´ìš© ì •ë¦¬

1. **Action Maps í™œìš©** : í•„ìš”ì— ë”°ë¼ `Action Map` ì„ ë§Œë“¤ì–´ ì…ë ¥ ë°©ì‹ì„ êµ¬ë¶„í•˜ê³ , `SwitchActionMap()` í•¨ìˆ˜ë¡œ í•„ìš”í•œ ë§µë§Œ í™œì„±í™”/ë¹„í™œì„±í™”í•˜ì—¬ ê´€ë¦¬í•œë‹¤.
2. ì—°ì†ì ì¸ ê°’ì€ í´ë§(Polling), ë‹¨ë°œì„± ì…ë ¥ì´ë‚˜ ìƒíƒœ ë³€ê²½ ê°ì§€ëŠ” ì´ë²¤íŠ¸ë¡œ ê°’ì„ ì½ì–´ì˜¨ë‹¤.
3. ì…ë ¥ ì¤‘ë‹¨ -> `canceled` ì´ë²¤íŠ¸ë¡œ ê´€ë¦¬ ê°€ëŠ¥
4. ë¹„í™œì„±í™”(OnDisable) ì‹œ ì´ë²¤íŠ¸ êµ¬ë… í•´ì œ í•„ìˆ˜!
